{% extends 'base.html' %}
{% load static %}

{% block body_class %}hero-page{% endblock %}

{% block title %}Daniel Ahlberg - Professional Photographer in Stockholm, Sweden{% endblock %}
{% block description %}Award-winning photographer in Stockholm specializing in portrait, landscape, and event photography. Book your session with 10+ years of experience capturing authentic moments.{% endblock %}
{% block keywords %}Stockholm photographer, Swedish photographer, portrait photography Stockholm, event photographer Sweden, professional photography, Daniel Ahlberg{% endblock %}

{% block og_type %}website{% endblock %}
{% block twitter_card %}summary_large_image{% endblock %}

{% block structured_data %}
{
    "@context": "https://schema.org",
    "@type": ["ProfessionalService", "LocalBusiness"],
    "name": "Daniel Ahlberg Photography",
    "image": [
        "{{ request.scheme }}://{{ request.get_host }}{% static 'images/daniel-ahlberg.jpg' %}",
        "{{ request.scheme }}://{{ request.get_host }}{% static 'images/portfolio-sample-1.jpg' %}",
        "{{ request.scheme }}://{{ request.get_host }}{% static 'images/portfolio-sample-2.jpg' %}"
    ],
    "description": "Professional photographer in Stockholm, Sweden with over 10 years of experience in portrait, landscape, and event photography.",
    "address": {
        "@type": "PostalAddress",
        "addressLocality": "Stockholm",
        "addressRegion": "Stockholm County",
        "addressCountry": "Sweden"
    },
    "geo": {
        "@type": "GeoCoordinates",
        "latitude": 59.3293,
        "longitude": 18.0686
    },
    "url": "{{ request.build_absolute_uri }}",
    "telephone": "+46123456789",
    "email": "hello@danielahlberg.me",
    "priceRange": "$$",
    "openingHours": "Mo-Fr 09:00-18:00",
    "serviceType": ["Portrait Photography", "Event Photography", "Landscape Photography", "Wedding Photography", "Commercial Photography"],
    "areaServed": [
        {
            "@type": "City",
            "name": "Stockholm"
        },
        {
            "@type": "Country",
            "name": "Sweden"
        }
    ],
    "hasOfferCatalog": {
        "@type": "OfferCatalog",
        "name": "Photography Services",
        "itemListElement": [
            {
                "@type": "Offer",
                "itemOffered": {
                    "@type": "Service",
                    "name": "Portrait Photography Session",
                    "description": "Professional portrait photography sessions for individuals and families"
                }
            },
            {
                "@type": "Offer",
                "itemOffered": {
                    "@type": "Service",
                    "name": "Event Photography",
                    "description": "Complete event coverage including weddings, corporate events, and celebrations"
                }
            }
        ]
    },
    "founder": {
        "@type": "Person",
        "name": "Daniel Ahlberg",
        "jobTitle": "Professional Photographer",
        "image": "{{ request.scheme }}://{{ request.get_host }}{% static 'images/daniel-ahlberg.jpg' %}",
        "worksFor": {
            "@type": "Organization",
            "name": "Daniel Ahlberg Photography"
        },
        "sameAs": [
            "https://instagram.com/danielahlberg",
            "https://linkedin.com/in/danielahlberg"
        ]
    },
    "aggregateRating": {
        "@type": "AggregateRating",
        "ratingValue": "4.9",
        "reviewCount": "127"
    }
}
{% endblock %}

{% block content %}
<section id="home" class="hero-section vh-100 position-relative">
    <!-- Background Carousel -->
    <div id="heroCarousel" class="carousel slide carousel-fade" data-bs-ride="carousel" data-bs-interval="6000">
        <div class="carousel-inner">
            {% if hero_photos %}
                {% for photo in hero_photos %}
                <div class="carousel-item {% if forloop.first %}active{% endif %}">
                    <div class="hero-bg" style="background-image: url('{{ photo.image.url }}');"></div>
                </div>
                {% endfor %}
            {% else %}
                <div class="carousel-item active">
                    <div class="hero-bg" style="background-image: url('https://images.unsplash.com/photo-1547036967-23d11aacaee0?ixlib=rb-4.0.3&auto=format&fit=crop&w=2400&q=90');"></div>
                </div>
                <div class="carousel-item">
                    <div class="hero-bg" style="background-image: url('https://images.unsplash.com/photo-1452587925148-ce544e77e70d?ixlib=rb-4.0.3&auto=format&fit=crop&w=2400&q=90');"></div>
                </div>
                <div class="carousel-item">
                    <div class="hero-bg" style="background-image: url('https://images.unsplash.com/photo-1506905925346-21bda4d32df4?ixlib=rb-4.0.3&auto=format&fit=crop&w=2400&q=90');"></div>
                </div>
            {% endif %}
        </div>
    </div>

    <!-- Dark overlay -->
    <div class="hero-overlay position-absolute top-0 start-0 w-100 h-100"></div>

    <!-- Hero content -->
    <div class="hero-content position-relative z-2">
        <div class="hero-text-container">
            <h1 class="fade-text display-1 mb-3"><span class="hero-name-first">Daniel</span> <span class="hero-name-last">Ahlberg</span></h1>
        </div>
        <div class="hero-subtitle-container">
            <p class="hero-subtitle text-white text-uppercase fs-4 fw-light letter-spacing-wide mb-4">Photographer. Stockholm.</p>
            <div class="hero-cta-buttons">
                <a href="#featured-work" class="btn btn-hero-outline me-3">View Portfolio</a>
                <a href="{% url 'portfolio:contact' %}" class="btn btn-hero-outline">Book Session</a>
            </div>
        </div>
    </div>
</section>

<!-- Advanced Portfolio Gallery Section -->
<section id="featured-work" class="advanced-portfolio-section" style="padding: 120px 0; background: #fafafa;">
    <div class="portfolio-container">
        <!-- Portfolio Header -->
        <div class="portfolio-header">
            <h2 class="portfolio-main-title">Featured Work</h2>
        </div>
        <div class="advanced-portfolio-grid" id="home-gallery">
            {% if featured_photos %}
                {% for photo in featured_photos %}
                <div class="grid-item grid-large-landscape" data-delay="{{ forloop.counter0|add:100 }}">
                    <img src="{{ photo.image.url }}"
                         alt="{{ photo.title }}" class="grid-image" data-title="{{ photo.title }}" data-description="{{ photo.description|default:'Featured work' }}" loading="lazy">
                    <div class="image-overlay">
                        <div class="overlay-content">
                            <h3>{{ photo.title }}</h3>
                            <p>{{ photo.category.name }}</p>
                        </div>
                    </div>
                </div>
                {% endfor %}
            {% else %}
                <div class="grid-item grid-large-landscape" data-delay="0">
                    <img src="https://images.unsplash.com/photo-1506905925346-21bda4d32df4?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=90"
                         alt="Mountain Vista" class="grid-image" data-title="Mountain Vista" data-description="Natural beauty captured" loading="lazy">
                    <div class="image-overlay">
                        <div class="overlay-content">
                            <h3>Mountain Vista</h3>
                            <p>Landscape Photography</p>
                        </div>
                    </div>
                </div>
            {% endif %}
        </div>

        <div class="text-center mt-5">
            <a href="{% url 'portfolio:portfolio' %}" class="btn btn-dark fw-light text-uppercase px-4 py-2 font-modern">View Full Portfolio</a>
        </div>
    </div>
</section>

<section class="py-5 home-about-section">
    <div class="container">
        <div class="row align-items-center">
            <!-- Heading only on mobile, shown first -->
            <div class="col-12 d-lg-none about-heading-mobile">
                <h2 class="portfolio-main-title">About Daniel</h2>
            </div>

            <!-- Text column - shows on desktop with heading, hidden on mobile -->
            <div class="col-lg-8 d-none d-lg-block about-text">
                <h2 class="portfolio-main-title">About Daniel</h2>
                <p class="lead fw-light lh-lg mb-4 font-serif">Born and raised in Stockholm, Sweden, I'm a 32-year-old photographer passionate about capturing the authentic moments that make life extraordinary. With over a decade of experience, I specialize in portrait, landscape, and event photography.</p>
                <div class="text-start">
                    <a href="{% url 'portfolio:about' %}" class="btn btn-outline-dark fw-light text-uppercase px-4 py-2 font-modern me-3">Learn More</a>
                    <a href="{% url 'portfolio:contact' %}" class="btn btn-dark fw-light text-uppercase px-4 py-2 font-modern">Book a Session</a>
                </div>
            </div>

            <!-- Image - shows on both -->
            <div class="col-lg-4 col-12 text-center about-image">
                {% if about_photo %}
                <img src="{{ about_photo.image.url }}"
                     alt="Daniel Ahlberg - Stockholm Photographer"
                     class="img-fluid rounded shadow">
                {% else %}
                <img src="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80"
                     alt="Daniel Ahlberg - Stockholm Photographer"
                     class="img-fluid rounded shadow">
                {% endif %}
            </div>

            <!-- Text and buttons on mobile only, shown after image -->
            <div class="col-12 d-lg-none about-text-mobile">
                <p class="lead fw-light lh-lg mb-4 font-serif">Born and raised in Stockholm, Sweden, I'm a 32-year-old photographer passionate about capturing the authentic moments that make life extraordinary. With over a decade of experience, I specialize in portrait, landscape, and event photography.</p>
                <div class="text-start">
                    <a href="{% url 'portfolio:about' %}" class="btn btn-outline-dark fw-light text-uppercase px-4 py-2 font-modern me-3">Learn More</a>
                    <a href="{% url 'portfolio:contact' %}" class="btn btn-dark fw-light text-uppercase px-4 py-2 font-modern">Book a Session</a>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Advanced Lightbox -->
<div class="advanced-lightbox" id="home-advanced-lightbox">
    <div class="lightbox-close">&times;</div>
    <div class="lightbox-content">
        <img class="lightbox-image" src="" alt="">
        <div class="lightbox-info">
            <div class="lightbox-title"></div>
            <div class="lightbox-description"></div>
        </div>
        <div class="lightbox-nav">
            <button class="nav-btn prev-btn">‹</button>
            <button class="nav-btn next-btn">›</button>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    const heroCarousel = document.getElementById('heroCarousel');
    if (heroCarousel) {
        const carousel = new bootstrap.Carousel(heroCarousel, {
            interval: 6000,
            ride: 'carousel',
            pause: false,
            wrap: true
        });
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            const href = this.getAttribute('href');
            if (href !== '#' && href !== '') {
                e.preventDefault();
                const target = document.querySelector(href);
                if (target) {
                    const navbarHeight = document.querySelector('.navbar').offsetHeight;
                    const targetPosition = target.offsetTop - navbarHeight - 20;
                    window.scrollTo({
                        top: targetPosition,
                        behavior: 'smooth'
                    });
                }
            }
        });
    });

    const observerOptions = {
        root: null,
        rootMargin: '-10% 0px -10% 0px',
        threshold: 0.1
    };

    const homePortfolioObserver = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                const item = entry.target;
                const delay = item.getAttribute('data-delay') || 0;
                setTimeout(() => {
                    item.classList.remove('scroll-animate');
                    item.classList.add('animate-in');
                }, delay);
            }
        });
    }, observerOptions);

    const homePortfolioItems = document.querySelectorAll('#home-gallery .grid-item');
    homePortfolioItems.forEach(item => {
        item.classList.add('scroll-animate');
        homePortfolioObserver.observe(item);
    });

    let homeCurrentIndex = 0;
    const homeVisibleItems = Array.from(homePortfolioItems);
    const homeLightbox = document.getElementById('home-advanced-lightbox');
    const homeLightboxImage = homeLightbox.querySelector('.lightbox-image');
    const homeLightboxTitle = homeLightbox.querySelector('.lightbox-title');
    const homeLightboxDescription = homeLightbox.querySelector('.lightbox-description');
    const homeCloseBtn = homeLightbox.querySelector('.lightbox-close');
    const homePrevBtn = homeLightbox.querySelector('.prev-btn');
    const homeNextBtn = homeLightbox.querySelector('.next-btn');

    function openHomeLightbox(index) {
        homeCurrentIndex = index;
        updateHomeLightboxContent();
        homeLightbox.classList.add('active');
        document.body.style.overflow = 'hidden';
    }

    function closeHomeLightbox() {
        homeLightbox.classList.remove('active');
        document.body.style.overflow = 'auto';
    }

    function updateHomeLightboxContent() {
        const currentItem = homeVisibleItems[homeCurrentIndex];
        const img = currentItem.querySelector('.grid-image');
        const title = img.getAttribute('data-title');
        const description = img.getAttribute('data-description');
        homeLightboxImage.src = img.src;
        homeLightboxImage.alt = title;
        homeLightboxTitle.textContent = title;
        homeLightboxDescription.textContent = description;
        homePrevBtn.disabled = homeCurrentIndex === 0;
        homeNextBtn.disabled = homeCurrentIndex === homeVisibleItems.length - 1;
    }

    function nextHomeImage() {
        if (homeCurrentIndex < homeVisibleItems.length - 1) {
            homeCurrentIndex++;
            updateHomeLightboxContent();
        }
    }

    function prevHomeImage() {
        if (homeCurrentIndex > 0) {
            homeCurrentIndex--;
            updateHomeLightboxContent();
        }
    }

    homePortfolioItems.forEach((item, index) => {
        item.addEventListener('click', function() {
            const visibleIndex = homeVisibleItems.indexOf(item);
            if (visibleIndex !== -1) {
                openHomeLightbox(visibleIndex);
            }
        });
    });

    homeCloseBtn.addEventListener('click', closeHomeLightbox);
    homeLightbox.addEventListener('click', function(e) {
        if (e.target === homeLightbox) closeHomeLightbox();
    });

    homeNextBtn.addEventListener('click', nextHomeImage);
    homePrevBtn.addEventListener('click', prevHomeImage);

    document.addEventListener('keydown', function(e) {
        if (homeLightbox.classList.contains('active')) {
            switch(e.key) {
                case 'Escape':
                    closeHomeLightbox();
                    break;
                case 'ArrowLeft':
                    prevHomeImage();
                    break;
                case 'ArrowRight':
                    nextHomeImage();
                    break;
            }
        }
    });
});
</script>
{% endblock %}
