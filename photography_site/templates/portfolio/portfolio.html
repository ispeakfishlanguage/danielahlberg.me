{% extends 'base.html' %}
{% load static %}

{% block title %}Photography Portfolio - Daniel Ahlberg | Stockholm Photographer{% endblock %}
{% block description %}Browse Daniel Ahlberg's photography portfolio featuring stunning portraits, landscapes, and events. Professional photography services in Stockholm, Sweden.{% endblock %}
{% block keywords %}photography portfolio Stockholm, portrait gallery, landscape photography Sweden, event photography portfolio, professional photographer work{% endblock %}

{% block canonical %}{{ request.scheme }}://{{ request.get_host }}{% url 'portfolio:portfolio' %}{% if current_category %}?category={{ current_category }}{% endif %}{% endblock %}

{% block structured_data %}
{
    "@context": "https://schema.org",
    "@type": "ImageGallery",
    "name": "Daniel Ahlberg Photography Portfolio",
    "description": "Professional photography portfolio showcasing portraits, landscapes, and events by Stockholm photographer Daniel Ahlberg",
    "url": "{{ request.build_absolute_uri }}",
    "creator": {
        "@type": "Person",
        "name": "Daniel Ahlberg",
        "jobTitle": "Professional Photographer"
    }
}
{% endblock %}

{% block content %}

<!-- Advanced Portfolio Gallery Section -->
<section class="advanced-portfolio-section">
    <div class="portfolio-container">
        <!-- Portfolio Header -->
        <div class="portfolio-header">
            <h1 class="portfolio-main-title">Portfolio</h1>
            <p class="portfolio-subtitle">A curated selection of my photographic work</p>
        </div>

        <!-- Collection Filter Buttons -->
        <div class="filter-container">
            <button class="advanced-filter-btn active" data-filter="all">
                <span>All</span>
            </button>
            <button class="advanced-filter-btn" data-filter="portraits">
                <span>Portraits</span>
            </button>
            <button class="advanced-filter-btn" data-filter="landscape">
                <span>Landscapes</span>
            </button>
            <button class="advanced-filter-btn" data-filter="events">
                <span>Events</span>
            </button>
            <button class="advanced-filter-btn" data-filter="projects">
                <span>Projects</span>
            </button>
        </div>

        <!-- Advanced Portfolio Grid -->
        <div class="advanced-portfolio-grid" id="portfolio-grid">

            <div class="grid-item grid-large-landscape parallax-slow" data-category="landscape" data-delay="0">
                <img src="https://images.unsplash.com/photo-1506905925346-21bda4d32df4?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=90"
                     alt="Mountain Vista" class="grid-image" data-title="Mountain Vista" data-description="Sunrise over the peaks" loading="lazy">
                <div class="image-overlay">
                    <div class="overlay-content">
                        <h3>Mountain Vista</h3>
                        <p>Landscape Photography</p>
                    </div>
                </div>
            </div>

            <div class="grid-item grid-portrait" data-category="portraits" data-delay="200">
                <img src="https://images.unsplash.com/photo-1529626455594-4ff0802cfb7e?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=90"
                     alt="Fashion Portrait" class="grid-image" data-title="Fashion Portrait" data-description="Studio fashion photography session" loading="lazy">
                <div class="image-overlay">
                    <div class="overlay-content">
                        <h3>Fashion Portrait</h3>
                        <p>Studio Photography</p>
                    </div>
                </div>
            </div>

            <div class="grid-item grid-square parallax-medium" data-category="projects" data-delay="100">
                <img src="https://images.unsplash.com/photo-1441986300917-64674bd600d8?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=90"
                     alt="Urban Life" class="grid-image" data-title="Urban Project" data-description="Creative urban photography project" loading="lazy">
                <div class="image-overlay">
                    <div class="overlay-content">
                        <h3>Urban Project</h3>
                        <p>Creative Photography</p>
                    </div>
                </div>
            </div>

            <div class="grid-item grid-medium-landscape" data-category="events" data-delay="300">
                <img src="https://images.unsplash.com/photo-1519741497674-611481863552?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000&q=90"
                     alt="Wedding Ceremony" class="grid-image" data-title="Wedding Ceremony" data-description="Intimate wedding moment" loading="lazy">
                <div class="image-overlay">
                    <div class="overlay-content">
                        <h3>Wedding Ceremony</h3>
                        <p>Event Photography</p>
                    </div>
                </div>
            </div>

            <div class="grid-item grid-small-square" data-category="portraits" data-delay="150">
                <img src="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=90"
                     alt="Professional Portrait" class="grid-image" data-title="Professional Portrait" data-description="Corporate headshot session" loading="lazy">
                <div class="image-overlay">
                    <div class="overlay-content">
                        <h3>Professional</h3>
                        <p>Headshots</p>
                    </div>
                </div>
            </div>

            <div class="grid-item grid-wide-landscape parallax-slow" data-category="landscape" data-delay="250">
                <img src="https://images.unsplash.com/photo-1501594907352-04cda38ebc29?ixlib=rb-4.0.3&auto=format&fit=crop&w=1400&q=90"
                     alt="Lake Reflection" class="grid-image" data-title="Lake Reflection" data-description="Perfect mirror reflection" loading="lazy">
                <div class="image-overlay">
                    <div class="overlay-content">
                        <h3>Lake Reflection</h3>
                        <p>Nature Photography</p>
                    </div>
                </div>
            </div>

            <!-- Row 4 -->
            <div class="grid-item grid-portrait-tall parallax-medium" data-category="portraits" data-delay="400">
                <img src="https://images.unsplash.com/photo-1544005313-94ddf0286df2?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=90"
                     alt="Natural Portrait" class="grid-image" data-title="Natural Portrait" data-description="Outdoor portrait session" loading="lazy">
                <div class="image-overlay">
                    <div class="overlay-content">
                        <h3>Natural Portrait</h3>
                        <p>Outdoor Session</p>
                    </div>
                </div>
            </div>

            <div class="grid-item grid-medium-square" data-category="landscape" data-delay="350">
                <img src="https://images.unsplash.com/photo-1470071459604-3b5ec3a7fe05?ixlib=rb-4.0.3&auto=format&fit=crop&w=900&q=90"
                     alt="Golden Hour" class="grid-image" data-title="Golden Hour" data-description="Sunset landscape photography" loading="lazy">
                <div class="image-overlay">
                    <div class="overlay-content">
                        <h3>Golden Hour</h3>
                        <p>Sunset Photography</p>
                    </div>
                </div>
            </div>

            <div class="grid-item grid-small-portrait" data-category="projects" data-delay="500">
                <img src="https://images.unsplash.com/photo-1449824913935-59a10b8d2000?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=90"
                     alt="Architecture Project" class="grid-image" data-title="Architecture Project" data-description="Modern architectural photography series" loading="lazy">
                <div class="image-overlay">
                    <div class="overlay-content">
                        <h3>Architecture</h3>
                        <p>Photo Series</p>
                    </div>
                </div>
            </div>

            <!-- Row 5 -->
            <div class="grid-item grid-large-square" data-category="events" data-delay="200">
                <img src="https://images.unsplash.com/photo-1533174072545-7a4b6ad7a6c3?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000&q=90"
                     alt="Wedding Reception" class="grid-image" data-title="Wedding Reception" data-description="Celebration moments" loading="lazy">
                <div class="image-overlay">
                    <div class="overlay-content">
                        <h3>Wedding Reception</h3>
                        <p>Celebration</p>
                    </div>
                </div>
            </div>

            <div class="grid-item grid-medium-portrait parallax-fast" data-category="portraits" data-delay="300">
                <img src="https://images.unsplash.com/photo-1500648767791-00dcc994a43e?ixlib=rb-4.0.3&auto=format&fit=crop&w=700&q=90"
                     alt="Lifestyle Portrait" class="grid-image" data-title="Lifestyle Portrait" data-description="Candid lifestyle moment" loading="lazy">
                <div class="image-overlay">
                    <div class="overlay-content">
                        <h3>Lifestyle</h3>
                        <p>Candid Moments</p>
                    </div>
                </div>
            </div>

            <!-- Row 6 -->
            <div class="grid-item grid-ultra-wide" data-category="landscape" data-delay="100">
                <img src="https://images.unsplash.com/photo-1469474968028-56623f02e42e?ixlib=rb-4.0.3&auto=format&fit=crop&w=1600&q=90"
                     alt="Forest Path" class="grid-image" data-title="Forest Path" data-description="Morning light through trees" loading="lazy">
                <div class="image-overlay">
                    <div class="overlay-content">
                        <h3>Forest Path</h3>
                        <p>Morning Light</p>
                    </div>
                </div>
            </div>

            <!-- Row 7 -->
            <div class="grid-item grid-small-landscape" data-category="events" data-delay="450">
                <img src="https://images.unsplash.com/photo-1511795409834-ef04bbd61622?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=90"
                     alt="Corporate Event" class="grid-image" data-title="Corporate Event" data-description="Business conference photography" loading="lazy">
                <div class="image-overlay">
                    <div class="overlay-content">
                        <h3>Corporate Event</h3>
                        <p>Business Photography</p>
                    </div>
                </div>
            </div>

            <div class="grid-item grid-square-large parallax-medium" data-category="projects" data-delay="150">
                <img src="https://images.unsplash.com/photo-1519501025264-65ba15a82390?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000&q=90"
                     alt="Urban Documentary" class="grid-image" data-title="Urban Documentary" data-description="Documentary photography project" loading="lazy">
                <div class="image-overlay">
                    <div class="overlay-content">
                        <h3>Urban Documentary</h3>
                        <p>Photo Project</p>
                    </div>
                </div>
            </div>

            <div class="grid-item grid-portrait-medium" data-category="portraits" data-delay="600">
                <img src="https://images.unsplash.com/photo-1524504388940-b1c1722653e1?ixlib=rb-4.0.3&auto=format&fit=crop&w=700&q=90"
                     alt="Creative Portrait" class="grid-image" data-title="Creative Portrait" data-description="Artistic portrait session" loading="lazy">
                <div class="image-overlay">
                    <div class="overlay-content">
                        <h3>Creative Portrait</h3>
                        <p>Artistic Vision</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Advanced Lightbox -->
    <div class="advanced-lightbox" id="advanced-lightbox">
        <div class="lightbox-close">&times;</div>
        <div class="lightbox-content">
            <img class="lightbox-image" src="" alt="">
            <div class="lightbox-info">
                <div class="lightbox-title"></div>
                <div class="lightbox-description"></div>
            </div>
            <div class="lightbox-nav">
                <button class="nav-btn prev-btn">‹</button>
                <button class="nav-btn next-btn">›</button>
            </div>
        </div>
    </div>
</section>

{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Advanced Portfolio Gallery with Scroll Animations and Parallax

    // Intersection Observer for scroll-triggered animations
    const observerOptions = {
        root: null,
        rootMargin: '-10% 0px -10% 0px',
        threshold: 0.1
    };

    const portfolioObserver = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                const item = entry.target;
                const delay = item.getAttribute('data-delay') || 0;

                setTimeout(() => {
                    item.classList.remove('scroll-animate');
                    item.classList.add('animate-in');
                }, delay);
            }
        });
    }, observerOptions);

    // Parallax scroll effects for selected images
    const parallaxObserver = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                const item = entry.target;
                const speed = item.classList.contains('parallax-slow') ? 0.5 :
                            item.classList.contains('parallax-medium') ? 0.3 : 0.7;

                const scrolled = window.pageYOffset;
                const rect = item.getBoundingClientRect();
                const elementTop = rect.top + scrolled;

                function updateParallax() {
                    const currentScroll = window.pageYOffset;
                    const yPos = Math.max(0, (currentScroll - elementTop) * speed);

                    // Only apply parallax if item is not currently animating in
                    if (!item.classList.contains('scroll-animate')) {
                        const currentTransform = item.style.transform || '';
                        const scaleMatch = currentTransform.match(/scale\([^)]+\)/);
                        const scaleTransform = scaleMatch ? scaleMatch[0] : 'scale(1)';
                        item.style.transform = `translateY(${yPos}px) ${scaleTransform}`;
                    }
                }

                window.addEventListener('scroll', updateParallax);
                updateParallax();
            }
        });
    }, {
        root: null,
        rootMargin: '0px',
        threshold: 0
    });

    // Initialize portfolio items
    const portfolioItems = document.querySelectorAll('.grid-item');
    let visibleItems = Array.from(portfolioItems);

    // Add scroll-animate class initially for animation effect
    portfolioItems.forEach(item => {
        item.classList.add('scroll-animate');
        portfolioObserver.observe(item);

        // Initialize parallax for items with parallax classes
        if (item.classList.contains('parallax-slow') ||
            item.classList.contains('parallax-medium') ||
            item.classList.contains('parallax-fast')) {
            parallaxObserver.observe(item);
        }
    });

    // Advanced filtering with smooth animations
    const filterBtns = document.querySelectorAll('.advanced-filter-btn');

    filterBtns.forEach(btn => {
        btn.addEventListener('click', function() {
            const filter = this.getAttribute('data-filter');

            // Update active button
            filterBtns.forEach(b => b.classList.remove('active'));
            this.classList.add('active');

            // Animate items out first
            portfolioItems.forEach(item => {
                item.classList.add('filtering-out');
            });

            setTimeout(() => {
                // Filter and animate in
                portfolioItems.forEach(item => {
                    const itemCategory = item.getAttribute('data-category');
                    item.classList.remove('filtering-out');

                    if (filter === 'all' || itemCategory === filter) {
                        item.classList.remove('hidden');
                        item.classList.add('visible');
                        // Re-trigger animation
                        setTimeout(() => {
                            item.classList.remove('scroll-animate');
                            item.classList.add('animate-in');
                        }, Math.random() * 300);
                    } else {
                        item.classList.add('hidden');
                        item.classList.remove('visible', 'animate-in');
                    }
                });

                // Update visible items for lightbox
                updateVisibleItems();
            }, 300);
        });
    });

    function updateVisibleItems() {
        const activeFilter = document.querySelector('.advanced-filter-btn.active').getAttribute('data-filter');
        visibleItems = Array.from(portfolioItems).filter(item =>
            !item.classList.contains('hidden')
        );
    }

    // Advanced Lightbox functionality
    let currentIndex = 0;
    const lightbox = document.getElementById('advanced-lightbox');
    const lightboxImage = lightbox.querySelector('.lightbox-image');
    const lightboxTitle = lightbox.querySelector('.lightbox-title');
    const lightboxDescription = lightbox.querySelector('.lightbox-description');
    const closeBtn = lightbox.querySelector('.lightbox-close');
    const prevBtn = lightbox.querySelector('.prev-btn');
    const nextBtn = lightbox.querySelector('.next-btn');

    function openLightbox(index) {
        currentIndex = index;
        updateLightboxContent();
        lightbox.classList.add('active');
        document.body.style.overflow = 'hidden';
    }

    function closeLightbox() {
        lightbox.classList.remove('active');
        document.body.style.overflow = 'auto';
    }

    function updateLightboxContent() {
        const currentItem = visibleItems[currentIndex];
        const img = currentItem.querySelector('.grid-image');
        const title = img.getAttribute('data-title');
        const description = img.getAttribute('data-description');

        // Get high resolution version
        const highResSrc = img.src.replace('w=800', 'w=1600').replace('w=600', 'w=1600').replace('w=700', 'w=1600');

        lightboxImage.src = highResSrc;
        lightboxImage.alt = title;
        lightboxTitle.textContent = title;
        lightboxDescription.textContent = description;

        // Update navigation
        prevBtn.disabled = currentIndex === 0;
        nextBtn.disabled = currentIndex === visibleItems.length - 1;

        // Preload adjacent images
        preloadImages();
    }

    function preloadImages() {
        // Preload next image
        if (currentIndex < visibleItems.length - 1) {
            const nextImg = visibleItems[currentIndex + 1].querySelector('.grid-image');
            const nextHighRes = nextImg.src.replace('w=800', 'w=1600').replace('w=600', 'w=1600').replace('w=700', 'w=1600');
            const preloadNext = new Image();
            preloadNext.src = nextHighRes;
        }

        // Preload previous image
        if (currentIndex > 0) {
            const prevImg = visibleItems[currentIndex - 1].querySelector('.grid-image');
            const prevHighRes = prevImg.src.replace('w=800', 'w=1600').replace('w=600', 'w=1600').replace('w=700', 'w=1600');
            const preloadPrev = new Image();
            preloadPrev.src = prevHighRes;
        }
    }

    function nextImage() {
        if (currentIndex < visibleItems.length - 1) {
            currentIndex++;
            updateLightboxContent();
        }
    }

    function prevImage() {
        if (currentIndex > 0) {
            currentIndex--;
            updateLightboxContent();
        }
    }

    // Event listeners
    portfolioItems.forEach((item, index) => {
        item.addEventListener('click', function() {
            updateVisibleItems();
            const visibleIndex = visibleItems.indexOf(item);
            if (visibleIndex !== -1) {
                openLightbox(visibleIndex);
            }
        });
    });

    closeBtn.addEventListener('click', closeLightbox);
    lightbox.addEventListener('click', function(e) {
        if (e.target === lightbox) closeLightbox();
    });

    nextBtn.addEventListener('click', nextImage);
    prevBtn.addEventListener('click', prevImage);

    // Keyboard navigation
    document.addEventListener('keydown', function(e) {
        if (lightbox.classList.contains('active')) {
            switch(e.key) {
                case 'Escape':
                    closeLightbox();
                    break;
                case 'ArrowLeft':
                    prevImage();
                    break;
                case 'ArrowRight':
                    nextImage();
                    break;
            }
        }
    });

    // Initialize
    updateVisibleItems();
});
</script>
{% endblock %}